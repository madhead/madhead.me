---
title: 'madflow'
date: 2024-07-28T02:41:00+02:00
tags:
  - git
  - github
---

== Reasoning

WARNING: TODO

== The madflow

. https://semver.org[Semantic Versioning].

. link:../no-snapshots[No ``SNAPSHOT``s].

. The project uses https://github.com/allegro/axion-release-plugin[`axion-release-plugin`].

. Every published artifact is signed.

. Every PR, no matter what's the target branch, is built and published to GitHub Packages.
The version in this case is taken from the nearest preceding tag concatenated with the branch name, Git SHA and GitHub Actions run ID: `1.0.0-branch-name+cafebabe.42`.

. All the development is done in the `develop` branch.

. Only merges from the `develop` branch to the `master` branch are possible.
This means that every change should be first merged to the `release` to get to the `master` branch.

. The type of the branch merged to the `develop` branch determines the next tag:
  * `bugfix/\*`, `hotfix/\*`: - bugfixes, the next tag will be a patch version bump: `1.2.3` → `1.2.4`
  * `feature/\*`: new feature, the next tag will be a minor version bump: `1.2.3` → `1.3.0`
  * `major/\*`: a major release, the next tag will be a major version bump: `1.2.3` → `2.0.0`

. Every merge to the `master` branch is considered a public release and is published to the Maven Central.
Public release version is based from the nearest preceding tag: `1.2.3`

== Approximate visual representation of the rules above

[source,mermaid]
....
%%{
    init: {
        "gitGraph": {
            "showBranches": true,
            "showCommitLabel": true,
            "mainBranchName": "master"
        }
    }
  }%%
gitGraph LR:
    commit id: "Initial commit" tag: "0.0.1"
    branch develop
    checkout master
    branch feature/feature-1
    commit id: "0.0.1-feature-feature-1+0f72cce.10119244033"
    branch feature/feature-2
    commit id: "0.0.1-feature-feature-2+61dc52e.10119245289"
    checkout feature/feature-1
    commit id: "0.0.1-feature-feature-1+bc6a2c1.10119247132"
    commit id: "0.0.1-feature-feature-1+9b1b291.10119250803"
    checkout feature/feature-2
    commit id: "0.0.1-feature-feature-2+e921017.10119250803"
    checkout develop
    merge feature/feature-1
    merge feature/feature-2
    branch bugfix/bugfix-1
    commit
    checkout develop
    merge bugfix/bugfix-1
    checkout master
    merge develop
    checkout develop
    commit
....
